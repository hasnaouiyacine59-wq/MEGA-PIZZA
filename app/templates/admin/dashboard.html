<!-- templates/admin/dashboard.html -->
{% extends "admin/base_dashboard.html" %}

{% block title %}Dashboard - Mega Pizza Admin{% endblock %}

{% block content %}
<!-- Top Stats Bar - Horizontal Layout -->
<div class="top-stats-bar">
    <div class="stats-horizontal">
        <!-- Total Users -->
        <div class="stat-item">
            <div class="stat-label-horizontal">Total Users</div>
            <div class="stat-content-row">
                <div class="stat-icon-horizontal">
                    <i class="fas fa-users"></i>
                </div>
                <div class="stat-number-horizontal">{{ stats.total_users if stats else 0 }}</div>
            </div>
        </div>
        
        <!-- Active Users -->
        <div class="stat-item">
            <div class="stat-label-horizontal">Active Users</div>
            <div class="stat-content-row">
                <div class="stat-icon-horizontal">
                    <i class="fas fa-user-check"></i>
                </div>
                <div class="stat-number-horizontal">{{ stats.active_users if stats else 0 }}</div>
            </div>
        </div>
        
        <!-- Administrators -->
        <div class="stat-item">
            <div class="stat-label-horizontal">Administrators</div>
            <div class="stat-content-row">
                <div class="stat-icon-horizontal">
                    <i class="fas fa-user-shield"></i>
                </div>
                <div class="stat-number-horizontal">{{ stats.admins if stats else 0 }}</div>
            </div>
        </div>
        
        <!-- Delivery Drivers -->
        <div class="stat-item">
            <div class="stat-label-horizontal">Delivery Drivers</div>
            <div class="stat-content-row">
                <div class="stat-icon-horizontal">
                    <i class="fas fa-truck"></i>
                </div>
                <div class="stat-number-horizontal">{{ stats.drivers if stats else 0 }}</div>
            </div>
        </div>
        
        <!-- Time Badge -->
        <div class="stat-item time-badge">
            <div class="stat-label-horizontal">System Time</div>
            <div class="stat-content-row">
                <div class="stat-icon-horizontal">
                    <i class="fas fa-clock"></i>
                </div>
                <div class="stat-number-horizontal" id="currentTime">
                    {{ current_time.strftime('%H:%M') if current_time else 'N/A' }}
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Statistics Cards -->
<!-- Statistics Cards - Updated Layout -->
<div class="stats-grid">
    <!-- Total Orders -->
    <div class="stat-card">
        <div class="stat-label">Total Orders</div>
        <div class="stat-content-row">
            <div class="stat-icon" style="background: linear-gradient(135deg, #8b5cf6, #7c3aed);">
                <i class="fas fa-shopping-cart"></i>
            </div>
            <div class="stat-number">{{ stats.total_orders if stats else 0 }}</div>
        </div>
    </div>
    
    <!-- Pending Orders -->
    <div class="stat-card">
        <div class="stat-label">Pending Orders</div>
        <div class="stat-content-row">
            <div class="stat-icon" style="background: linear-gradient(135deg, #ef4444, #dc2626);">
                <i class="fas fa-clock"></i>
            </div>
            <div class="stat-number">{{ stats.pending_orders if stats else 0 }}</div>
        </div>
    </div>
    
    <!-- Active Orders -->
    <div class="stat-card">
        <div class="stat-label">Active Orders</div>
        <div class="stat-content-row">
            <div class="stat-icon" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
                <i class="fas fa-truck-moving"></i>
            </div>
            <div class="stat-number">{{ stats.active_orders if stats else 0 }}</div>
        </div>
    </div>
    
    <!-- Restaurants -->
    <div class="stat-card">
        <div class="stat-label">Restaurants</div>
        <div class="stat-content-row">
            <div class="stat-icon" style="background: linear-gradient(135deg, #10b981, #059669);">
                <i class="fas fa-store"></i>
            </div>
            <div class="stat-number">{{ stats.restaurants_count if stats else 0 }}</div>
        </div>
    </div>
</div>

<!-- Quick Actions -->
<div class="quick-actions-grid">
    <a href="{{ url_for('admin.manage_customers') }}" class="quick-action-btn">
        <div class="quick-action-icon">
            <i class="fas fa-user-plus"></i>
        </div>
        <div class="quick-action-content">
            <h6>Manage Users</h6>
            <small>Add or edit user accounts</small>
        </div>
    </a>
    
    <a href="{{ url_for('admin.add_driver') }}" class="quick-action-btn">
        <div class="quick-action-icon">
            <i class="fas fa-truck"></i>
        </div>
        <div class="quick-action-content">
            <h6>Add Driver</h6>
            <small>Register delivery driver</small>
        </div>
    </a>
    
    <a href="{{ url_for('admin.manage_restaurants') }}" class="quick-action-btn">
        <div class="quick-action-icon">
            <i class="fas fa-store"></i>
        </div>
        <div class="quick-action-content">
            <h6>Restaurants</h6>
            <small>Manage restaurant partners</small>
        </div>
    </a>
    
    <a href="{{ url_for('admin.manage_orders') }}" class="quick-action-btn">
        <div class="quick-action-icon">
            <i class="fas fa-shopping-cart"></i>
        </div>
        <div class="quick-action-content">
            <h6>View Orders</h6>
            <small>Manage customer orders</small>
        </div>
    </a>
    
    <a href="{{ url_for('main.test_dashboard') }}" class="quick-action-btn">
        <div class="quick-action-icon">
            <i class="fas fa-vial"></i>
        </div>
        <div class="quick-action-content">
            <h6>Test Orders</h6>
            <small>Virtual order testing</small>
        </div>
    </a>
    
    <a href="{{ url_for('admin.system_health') }}" class="quick-action-btn">
        <div class="quick-action-icon">
            <i class="fas fa-server"></i>
        </div>
        <div class="quick-action-content">
            <h6>System Health</h6>
            <small>Monitor system status</small>
        </div>
    </a>
</div>

<!-- Recent Activity & System Status -->
<div class="row">
    <!-- Recent Activity -->
    <div class="col-lg-7 mb-4">
        <div class="activity-card">
            <div class="activity-header">
                <h5><i class="fas fa-history me-2"></i>Recent Activity</h5>
            </div>
            <div class="activity-body">
                {% if recent_orders %}
                    {% for single_order in recent_orders %}
                    <div class="activity-item">
                        <div class="activity-icon" style="background: linear-gradient(135deg, #667eea, #8b5cf6);">
                            <i class="fas fa-shopping-cart"></i>
                        </div>
                        <div class="activity-content">
                            <strong>Order #{{ single_order.order_id }}</strong>
                            <p>${{ "%.2f"|format(single_order.total_amount) }} - {{ single_order.order_status|title }}</p>
                        </div>
                        <div class="activity-time">{{ single_order.created_at.strftime('%H:%M') }}</div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="activity-item">
                        <div class="activity-icon" style="background: linear-gradient(135deg, #6b7280, #4b5563);">
                            <i class="fas fa-info-circle"></i>
                        </div>
                        <div class="activity-content">
                            <strong>No recent activity</strong>
                            <p>No orders found</p>
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- System Status -->
    <div class="col-lg-5 mb-4">
        <div class="activity-card h-100">
            <div class="activity-header">
                <h5><i class="fas fa-server me-2"></i>System Status</h5>
            </div>
            <div class="activity-body">
                <div class="system-status-grid">
                    <div class="status-card">
                        <div class="status-icon text-success">
                            <i class="fas fa-database"></i>
                        </div>
                        <h6>Database</h6>
                        <span class="status-badge bg-success">Online</span>
                        <p>{{ stats.total_users if stats else 0 }} users</p>
                    </div>
                    
                    <div class="status-card">
                        <div class="status-icon text-success">
                            <i class="fas fa-store"></i>
                        </div>
                        <h6>Restaurants</h6>
                        <span class="status-badge bg-success">{{ stats.restaurants_count if stats else 0 }} active</span>
                        <p>All systems operational</p>
                    </div>
                    
                    <div class="status-card">
                        <div class="status-icon text-primary">
                            <i class="fas fa-truck"></i>
                        </div>
                        <h6>Drivers</h6>
                        <span class="status-badge bg-primary">{{ stats.drivers if stats else 0 }} total</span>
                        <p>{{ stats.active_drivers if stats else 0 }} available</p>
                    </div>
                    
                    <div class="status-card">
                        <div class="status-icon text-success">
                            <i class="fas fa-shopping-cart"></i>
                        </div>
                        <h6>Orders Today</h6>
                        <span class="status-badge bg-success">{{ stats.today_orders if stats else 0 }}</span>
                        <p>{{ stats.pending_orders if stats else 0 }} pending</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}